 

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" type="text/css" href="/css/main.css">
  <link rel="stylesheet" type="text/css" href="/css/art.css">
  <link rel="icon" type="images/png" href="/images/favicon.png">
  <script src="/js/element.js"></script>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.4.0/build/styles/atom-one-light.min.css">
  <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.4.0/build/highlight.min.js"></script>
</head>

<body>
  <script>
    window.onload = function() {
      loadMath();
      drawSaying();
      hljs.configure({ tabReplace: '  ' });
      hljs.initHighlighting()
    }
  </script>

  <div class="content">
    <div class="sidebar" id="sidebar">
      <div class="sidebar-title">
  <p style="font-weight: bold; font-size: 20px;"> 

Jacder's blog

  </p>
  <div class="saying" id="saying"> </div>
</div>
<div class="sidebar-body">

  <div class="sidebar-content">
    <ul class = "sidebar-menu">
      <a href="/">
        <li class="list-item sidebar-menu-item" id="sidebar-content-home">
          Home
        </li>
      </a>
      <a href="/articles">
        <li class="list-item sidebar-menu-item" id="sidebar-content-articles"
            style="background: #e5e5e5">
          Articles
        </li>
      </a>
      <a href="/tags">
        <li class="list-item sidebar-menu-item" id="sidebar-content-tags">
          Tags
        </li>
      </a>
    </ul>
  </div>

  <div class="sidebar-about">
    <div style="text-align: center; font-size: 16px;"> About me </div>
    <HR align="center">
    <div class="avatar-rotate" style="margin: 2 auto; width: min-content">
      <img class="avatar" alt="Jacder" src="/images/avatar.png">
    </div>
    <ul class="sidebar-links">

<li class="sidebar-links-item">
    <a href="https://github.com/coderoj" class="friend-link"> 
      Github 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://gitee.com/coderoj" class="friend-link"> 
      Gitee 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://codeforces.com/profile/yz6205" class="friend-link"> 
      CodeForces 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="mailto:coderoj@outlook.com" class="friend-link"> 
      Email 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://user.qzone.qq.com/2602904088" class="friend-link"> 
      QQ 
    </a>
  </li>

    </ul>
  </div>

  <ul class="sidebar-links">
    <div style="text-align: center; font-size: 16px;"> links </div>
    <HR align="center">

<li class="sidebar-links-item">
    <a href="https://www.luogu.com.cn/blog/DPair2005/#" class="friend-link"> 
      DPair
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://xyix.gitee.io" class="friend-link"> 
      x_Yi_x
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://oierwanhong.cc" class="friend-link"> 
      OIerwanhong
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://www.cnblogs.com/huangchenyan" class="friend-link"> 
      SevenDawns
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://www.cnblogs.com/Flying2018" class="friend-link"> 
      Flying2018
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://www.cnblogs.com/Forever-666" class="friend-link"> 
      Clovers
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="http://blog.leanote.com/rem_001" class="friend-link"> 
      REM_001
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://xyf007.ml" class="friend-link"> 
      xyf007
    </a>
  </li>

  </ul>

</div>

    </div>

    <div class="post" id="post">

      <h1 id="lct-%E5%8A%A8%E6%80%81%E7%BB%B4%E6%8A%A4%E8%B7%AF%E5%BE%84%E4%B8%8A%E9%A2%9C%E8%89%B2%E6%AE%B5%E6%95%B0">LCT 动态维护路径上颜色段数</h1>
<!--more-->
<blockquote>
<p>对于每个辅助树中的点，其表示的是原树的一条链</p>
<p>在每个点记录对应链上的段数</p>
<p>因为存在合并操作，所以同时也要记录区间最左最右两点颜色</p>
<p>合并操作相当于合并<code>s[0]</code> <code>this</code> <code>s[1]</code> 三段区间</p>
<p>新的<code>tot</code>=<code>s[0].tot + 1 + s[1].tot - (s[0].rc == c) - (s[1].lc == c)</code></p>
<p>注意：</p>
<ul>
<li>修改操作时要对整颗子树修改，此处也要懒标记</li>
<li><code>pushRev</code>操作时不仅是交换左右子树，也要交换<code>lc</code> 和 <code>rc</code></li>
</ul>
</blockquote>
<p>部分关键代码：</p>
<p><code>pushRev</code></p>
<pre><code class="lang-cpp">void pushRev() {
    rev ^= 1; swap(s[0],s[1]); swap(lc,rc); }
</code></pre>
<p><code>pushUp</code></p>
<pre><code class="lang-cpp">void pushUp() {
    if (s[0]==NULL &amp;&amp; s[1]==NULL) { lc=rc=c; tot=1; }
    else if (s[0]==NULL) { lc=c; rc=s[1]-&gt;rc; tot=s[1]-&gt;tot + (c!=s[1]-&gt;lc); }
    else if (s[1]==NULL) { lc=s[0]-&gt;lc; rc=c; tot=s[0]-&gt;tot + (c!=s[0]-&gt;rc); }
    else {
        lc=s[0]-&gt;lc; rc=s[1]-&gt;rc;
        tot = s[0]-&gt;tot + s[1]-&gt;tot + 1 - (s[0]-&gt;rc==c) - (c==s[1]-&gt;lc) ; } }
</code></pre>

      <br>
<HR class="hr-line">

<div style="font-size: 12px; display: flex;">
  <div>
    <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="/images/cc-by-nc-sa.png" /></a>
  </div>
  <div style="margin-left: 10px;">
    This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</div>


    </div>

  </div>
</body>
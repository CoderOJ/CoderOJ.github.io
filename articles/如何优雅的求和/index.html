 

<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" type="text/css" href="/css/main.css">
  <link rel="stylesheet" type="text/css" href="/css/art.css">
  <link rel="icon" type="images/png" href="/images/favicon.png">
  <script src="/js/element.js"></script>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.4.0/build/styles/atom-one-light.min.css">
  <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.4.0/build/highlight.min.js"></script>
</head>

<body>
  <script>
    window.onload = function() {
      loadMath();
      drawSaying();
      hljs.configure({ tabReplace: '  ' });
      hljs.initHighlighting()
    }
  </script>

  <div class="content">
    <div class="sidebar" id="sidebar">
      <div class="sidebar-title">
  <p style="font-weight: bold; font-size: 20px;"> 

Jacder's blog

  </p>
  <div class="saying" id="saying"> </div>
</div>
<div class="sidebar-body">

  <div class="sidebar-content">
    <ul class = "sidebar-menu">
      <a href="/">
        <li class="list-item sidebar-menu-item" id="sidebar-content-home">
          Home
        </li>
      </a>
      <a href="/articles">
        <li class="list-item sidebar-menu-item" id="sidebar-content-articles"
            style="background: #e5e5e5">
          Articles
        </li>
      </a>
      <a href="/tags">
        <li class="list-item sidebar-menu-item" id="sidebar-content-tags">
          Tags
        </li>
      </a>
    </ul>
  </div>

  <div class="sidebar-about">
    <div style="text-align: center; font-size: 16px;"> About me </div>
    <HR align="center">
    <div class="avatar-rotate" style="margin: 2 auto; width: min-content">
      <img class="avatar" alt="Jacder" src="/images/avatar.png">
    </div>
    <ul class="sidebar-links">

<li class="sidebar-links-item">
    <a href="https://github.com/coderoj" class="friend-link"> 
      Github 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://gitee.com/coderoj" class="friend-link"> 
      Gitee 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://luogu.com.cn/user/43368" class="friend-link"> 
      Luogu 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://codeforces.com/profile/yz6205" class="friend-link"> 
      CodeForces 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="mailto:coderoj@outlook.com" class="friend-link"> 
      Email 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://user.qzone.qq.com/2602904088" class="friend-link"> 
      QQ 
    </a>
  </li>

    </ul>
  </div>

  <ul class="sidebar-links">
    <div style="text-align: center; font-size: 16px;"> links </div>
    <HR align="center">

<li class="sidebar-links-item">
    <a href="https://www.luogu.com.cn/blog/DPair2005/#" class="friend-link"> 
      DPair
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://xyix.gitee.io" class="friend-link"> 
      x_Yi_x
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://oierwanhong.cc" class="friend-link"> 
      OIerwanhong
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://www.cnblogs.com/huangchenyan" class="friend-link"> 
      SevenDawns
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://www.cnblogs.com/Flying2018" class="friend-link"> 
      Flying2018
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://www.cnblogs.com/Forever-666" class="friend-link"> 
      Clovers
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="http://blog.leanote.com/rem_001" class="friend-link"> 
      REM_001
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://xyf007.ml" class="friend-link"> 
      xyf007
    </a>
  </li>

  </ul>

</div>

    </div>

    <div class="post" id="post">

      <h1 id="-%E6%B8%85%E5%8D%8E%E9%9B%86%E8%AE%AD2016-%E5%A6%82%E4%BD%95%E4%BC%98%E9%9B%85%E5%9C%B0%E6%B1%82%E5%92%8C">[清华集训2016] 如何优雅地求和</h1>
<h2 id="description">Description</h2>
<p>给定 $n,x$ 和 $m$ 次多项式 $f$ （给出 $0 \cdots m$ 的点值） ，求</p>
<script type="math/tex; mode=display">
\sum_{k=0}^n f(k) \binom{n}{k} x^k (1-x)^{n-k}</script><h2 id="tutorial">Tutorial</h2>
<p>设 $f$ 转化为下降幂多项式时的系数为 $b_0 \cdots b_m$</p>
<p>使用类似于联合省选组合数问题的技巧，我们有</p>
<script type="math/tex; mode=display">
\begin{aligned}
\sum_{k=0}^n f(k)\binom{n}{k} x^k (1-x)^{n-k}
&= \sum_{k=0}^n \sum_{i=0}^{m} b_i k^{\underline i} \binom{n}{k} x^k (1-x) ^{n-k} \\
&= \sum_{k=0}^n \sum_{i=0}^{m} b_i n^{\underline i} \binom{n-i}{k-i} x^k (1-x) ^{n-k} \\
&= \sum_{i=0}^{m} b_i n^{\underline i} \sum_{k=i}^n \binom{n-i}{k-i} x^k (1-x) ^{n-k} \\
&= \sum_{i=0}^{m} b_i n^{\underline i} x^i \sum_{k=0}^{n-i} \binom{n-i}{k} x^{k} (1-x) ^{n-i-k} \\
&= \sum_{i=0}^{m} b_i x^i n^{\underline i} &(1)
\end{aligned}</script><p>接下来考虑如何求 $b_i$，当然可以先插值再转为下降幂，但出题人给点值<del>显然</del>不是用来恶心人的，考虑直接通过点值求 $b_i$</p>
<p>因为</p>
<script type="math/tex; mode=display">
x^n = \sum_k \begin{Bmatrix} n\\k \end{Bmatrix} x^{\underline k}</script><p>设 $f$ 的普通幂系数为 $a_0 \cdots a_m$，我们有</p>
<script type="math/tex; mode=display">
\begin{aligned}
b_i &= \sum_j \begin{Bmatrix} j\\i \end{Bmatrix} a_j &(2)
\end{aligned}</script><p>然后考虑一个恒等式</p>
<script type="math/tex; mode=display">
\sum_{m} \binom{k}{m} \begin{Bmatrix} n\\m \end{Bmatrix} m! = k^n</script><p>这很容易用组合意义证明</p>
<p>二项式反演得到</p>
<script type="math/tex; mode=display">
\begin{aligned}
m! \begin{Bmatrix} n\\m \end{Bmatrix} &= \sum_k \binom{m}{k} k^n(-1)^{m-k} \\
   \begin{Bmatrix} n\\m \end{Bmatrix} &= \frac1{m!}\sum_k \binom{m}{k} k^n(-1)^{m-k} \\ 
\end{aligned}</script><p><del>我怎么把第二类斯特林数·行的式子推了一遍</del></p>
<p>带入 $(2)$，得到</p>
<script type="math/tex; mode=display">
\begin{aligned}
b_i &= \sum_j \begin{Bmatrix} j\\i \end{Bmatrix} a_j \\
&= \frac1{i!} \sum_j \sum_k \binom{i}{k}k^j(-1)^{i-k} a_j \\
&= \frac1{i!} \sum_k \binom{i}{k}(-1)^{i-k} \sum_j a_j k^j \\
&= \frac1{i!} \sum_k \binom{i}{k}(-1)^{i-k} f(k) \\
&= \sum_k \frac{f(k)}{k!} \frac{(-1)^{i-k}}{(i-k)!} \\
\end{aligned}</script><p>这十分的卷积，显然可以 $O(m \log m)$ 计算</p>
<p>然后把算出来的$b_i$ 带回 $(1)$ 就好了</p>
<h2 id="upd0">UPD0</h2>
<p>突然发现我好傻逼，转下降幂完全不用那么烦</p>
<script type="math/tex; mode=display">
\begin{aligned}
f(k) &= \sum_i b_ii! \times \frac{k^{\underline i}}{i!} \\
&= \sum_i b_i i! \binom{k}{i}
\end{aligned}</script><p>直接二项式反演</p>
<script type="math/tex; mode=display">
\begin{aligned}
b_k k! &= \sum_i (-1)^{k-i} \binom{k}{i} f(i) \\
b_k &= \sum_i \frac{(-1)^{k-i}}{(k-i)!} \frac{f(i)}{i!}
\end{aligned}</script><p>我之前在干什么。。。</p>

      <br>
<HR class="hr-line">

<div style="font-size: 12px; display: flex;">
  <div>
    <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="/images/cc-by-nc-sa.png" /></a>
  </div>
  <div style="margin-left: 10px;">
    This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License</a>.
  </div>
</div>


    </div>

  </div>
</body>
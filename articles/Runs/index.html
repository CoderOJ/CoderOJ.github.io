<head>
  <meta charset="UTF-8">
  <link rel="stylesheet" type="text/css" href="/css/main.css">
  <link rel="stylesheet" type="text/css" href="/css/art.css">
  <link rel="icon" type="images/png" href="/images/favicon.png">
  <script src="/js/element.js"></script>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.4.0/build/styles/atom-one-light.min.css">
  <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.4.0/build/highlight.min.js"></script>
  <title>
      Runs 学习笔记 - Jacder's blog
  </title>
</head>

<body>
  <script>
    window.onload = function() {
      loadMath();
      drawSaying();
      hljs.configure({ tabReplace: '  ' });
      hljs.initHighlighting()
    }
  </script>

  <div class="content">
    <div class="sidebar" id="sidebar">
      <div class="sidebar-title">
  <p style="font-weight: bold; font-size: 24px;"> 

Jacder's blog

  </p>
  <div class="saying" id="saying"> </div>
</div>
<div class="sidebar-body">

  <div class="sidebar-content">
    <ul class = "sidebar-menu">
      <a href="/">
        <li class="list-item sidebar-menu-item" id="sidebar-content-home">
          Home
        </li>
      </a>
      <a href="/articles">
        <li class="list-item sidebar-menu-item" id="sidebar-content-articles"
            style="background: #e5e5e5">
          Articles
        </li>
      </a>
      <a href="/tags">
        <li class="list-item sidebar-menu-item" id="sidebar-content-tags">
          Tags
        </li>
      </a>
    </ul>
  </div>

  <div class="sidebar-about">
  <div style="text-align: center; font-size: 16px;"> About me </div>
  <HR align="center">
  <div class="avatar-rotate" style="margin: 2 auto; width: min-content">
    <img class="avatar" alt="Jacder" src="/images/avatar.png">
  </div>

  <ul class="sidebar-links">
  <li class="sidebar-links-item">
    <a href="https://github.com/coderoj" class="friend-link">
      Github 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://gitee.com/coderoj" class="friend-link">
      Gitee 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://luogu.com.cn/user/43368" class="friend-link">
      Luogu 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://codeforces.com/profile/yz6205" class="friend-link">
      CodeForces 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="mailto:coderoj@outlook.com" class="friend-link">
      Email 
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://user.qzone.qq.com/2602904088" class="friend-link">
      QQ 
    </a>
  </li>
  </ul>

</div>

<ul class="sidebar-links">
  <div style="text-align: center; font-size: 16px;"> links </div>
  <HR align="center">

  <li class="sidebar-links-item">
    <a href="https://dpair.gitee.io" class="friend-link">
      DPair
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://xyix.gitee.io" class="friend-link">
      x_Yi_x
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://www.luogu.com.cn/blog/c2522943959/#" class="friend-link">
      OIerwanhong
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://www.cnblogs.com/huangchenyan" class="friend-link">
      SevenDawns
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://www.cnblogs.com/Flying2018" class="friend-link">
      Flying2018
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://www.cnblogs.com/Forever-666" class="friend-link">
      Clovers
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="http://blog.leanote.com/rem_001" class="friend-link">
      REM_001
    </a>
  </li>
<li class="sidebar-links-item">
    <a href="https://xyf007.ml" class="friend-link">
      xyf007
    </a>
  </li>

</ul>



</div>

    </div>

    <div class="post" id="post">

      <h1 id="runs-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0">Runs 学习笔记</h1>
<p>这个字符串菜鸡来填坑了。</p>
<p>照着孔姥爷的博客学的所以这篇博客会和孔姥爷的那篇很像<del>一模一样</del></p>
<h2 id="%E4%B8%80%E4%BA%9B%E8%AE%B0%E5%8F%B7%E5%92%8C%E7%BA%A6%E5%AE%9A">一些记号和约定</h2>
<ul>
<li>文章中的字符串下标从 $1$ 开始（代码中一般 index-0），$s_i,s[i]$ 表示字符串 $s$ 的第 $i$ 个字符，$|s|$ 表示 $s$ 的长度</li>
<li>$&gt;$ 和 $&lt;$ 表示字典序的比较</li>
<li>$\Sigma$ 表示字符集大小，$\Sigma^<em>$ 表示字符集为 $\Sigma$ 的字符串，$\Sigma^+ = \Sigma^</em> \setminus {\epsilon}$，即非空串集合。</li>
<li>$\epsilon$ 表示空串，$$$ 表示特殊字符，且 $\forall c \in \Sigma, $ &gt; c$</li>
<li>$\overline \Sigma = \Sigma \cup {$}$， $\overline{\Sigma^*}$ 表示字符集为 $\overline \Sigma$ 的字符串</li>
<li>默认普通字符串中不包含特殊字符 $$$</li>
<li>$st, s+t$ 均表示字符串拼接</li>
<li>$s^k$ 表示 $s$ 重复 $k$ 次得到的字符串，$s^\infty$ 表示 $s$ 重复无限次得到的字符串</li>
<li>$s^R$ 表示 $s$ 翻转过后的字符串</li>
<li>$s[i:j]$ 表示 $s$ 的第 $i$ 位到第 $j$ 位构成的子串，若 $i &gt; j$ 则为 $\epsilon$，$s[:i] = s[1:i], s[i:] = s[i:|s|]$</li>
<li>$s \prec t \Leftrightarrow s + $ &lt; v, s \succ t \Leftrightarrow s &gt; t + $$</li>
<li>$\operatorname{lcp}(s,t)$ 表示 $s$ 和 $t$ 的最长公共前缀</li>
<li>$\operatorname{period}$：整数 $l$ 是 $s$ 的一个 $\operatorname{period}$ 当且仅当 $\forall i \in [1, |s| - l], s<em>i = s</em>{i+l}$</li>
<li>$\operatorname{border}$：整数 $l$ 是 $s$ 的 $\operatorname{border}$ 当且仅当 $\forall i \in [1,l], s<em>i = s</em>{n - l + i}$</li>
<li>整循环串：$s$ 是一个整循环串当且仅当 $\exists t \in \Sigma^*, s = t^k (k \geq 2)$</li>
<li>循环串：$s$ 是一个循环串当且仅当 $\exists t \in \Sigma^*, s = t^k + t[:p]$， 其中 $k$ 是任意整数，$p&lt;|t|$</li>
<li>最短循环节：长度最小的 $t$ 满足 $s = t^k (k \geq 2)$</li>
</ul>
<h2 id="lyndon-word">Lyndon Word</h2>
<p>定义 $s$ 是一个 Lyndon Word 当且仅当 $s$ 比它所有的后缀都要小，即 $\forall i \in [2,|s|], s &lt; s[i:]$。</p>
<p>比如 $\texttt{ababb}$ 是一个 Lyndon Word 而 $\texttt{abab}$ 不是。</p>
<h3 id="lyndon-%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%A7%E8%B4%A8">Lyndon 的一些性质</h3>
<ul>
<li>若 $u \prec v$，则 $\forall w_1, w_2 \in \Sigma^*, u + w_1 \prec v + w_2$</li>
<li>若 $s$ 是一个 Lyndon Word，则 $\forall i \in [1, |s|-1], s[:i] \prec s[n-i+1:]$</li>
<li>若 $u$ 和 $v$ 都是 Lyndon Word 且 $u &lt; v$，则 $uv$ 也是 Lyndon Word</li>
</ul>
<p><del>证明显然。</del></p>
<h3 id="lyndon-%E5%88%86%E8%A7%A3">Lyndon 分解</h3>
<p>定义：把一个字符串分为若干 Lyndon Word，并且字典序单调不增。</p>
<p>形式化地说，对于一个字符串 $s$，若 $t_1 + t_2 + \cdots + t_n = s, \forall i \in [1,n], t_i \text{ is a Lyndon Word}$ 且 $\forall i&gt;j, t_i \geq t_j$，那我们称 $t_1 \cdots t_n$ 为 $s$ 的一个 Lyndon 分解。</p>
<p>通常采用 Duval 算法求 Lyndon 分解。</p>
<h4 id="duval-%E7%AE%97%E6%B3%95">Duval 算法</h4>
<p>考虑依次插入字符，维护当前的 Lyndon 分解。</p>
<p>我们假设分解形式为 $T + t^k + t[:p]$，其中 $T = t_1t_2\cdots t_m$ 且满足 $t_1 \geq t_2 \geq \cdots \geq t_m &gt; t$</p>
<p>设当前加入的字符为 $c$，$u = t[p + 1]$，分类讨论：</p>
<ul>
<li>$c = u$，则转移到分解 $T + t^k + t[:p+1]$</li>
<li>$c &lt; u$，则 $T \gets T + t + \cdots + t\text{(for m times)}$，并转移到分解 $T + (t + c)$</li>
<li>$c &gt; u$，则 $t^k + t[:p] + c$ 是一个 Lyndon Word，则转移到 $T + (t^kt[:p]c)^1 + \epsilon$</li>
</ul>
<p>具体地，我们考虑维护一个三元组 $(i,j,k)$ 其中 $i$ 是 $t+t[:p]$ 的首字母位置，$[j,k)$ 是最后一个循环节。</p>
<p>那么就可以如下转移：</p>
<ul>
<li>$c = u: (i,j,k) \gets (i, j+1, k+1)$</li>
<li>$c &lt; u: (i,j,k) \gets (k, k, k+1)$</li>
<li>$c &gt; u: (i,j,k) \gets (i, i, k+1)$</li>
</ul>
<p>代码如下:</p>
<pre><code class="lang-c">struct duval_triple
{
  int index;
  int loop_l, loop_r;
};

static int *duval(int *dest, const char *src)
{
  struct duval_triple pos = { 0, 0, 1 };

  while (src[pos.index])
  {
    pos.loop_l = pos.index;
    pos.loop_r = pos.index + 1;
    while (src[pos.loop_r] &amp;&amp; 
           src[pos.loop_l] &lt;= src[pos.loop_r])
    {
      if (src[pos.loop_l] &lt; src[pos.loop_r])
        pos.loop_l = pos.index;
      else pos.loop_l++;
      pos.loop_r++;
    }
    int len = pos.loop_r - pos.loop_l;
    while (pos.index &lt;= pos.loop_l)
    {
      pos.index += len;
      *dest++ = pos.index;
    }
  }
  return dest;
}
</code></pre>
<h3 id="lyndon-%E6%95%B0%E7%BB%84">Lyndon 数组</h3>

      <br>
<HR class="hr-line">

<div style="font-size: 12px; display: flex;">
  <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">
    <img alt="Creative Commons License" style="border-width:0" src="/images/cc-by-sa.png" />
  </a>
  <div style="margin-left: 10px;">
    This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/"> Creative Commons Attribution-ShareAlike 4.0 International License</a>.
  </div>
</div>


    </div>

  </div>
</body>